# MetaNodeSwap å‰ç«¯åŠŸèƒ½è¯´æ˜

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
3. [æ–°å¢åŠŸèƒ½](#æ–°å¢åŠŸèƒ½)
4. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
5. [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)

---

## é¡¹ç›®æ¦‚è¿°

MetaNodeSwap æ˜¯ä¸€ä¸ªåŸºäº UniswapV3 ç®€åŒ–ç‰ˆæœ¬çš„å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€å‰ç«¯åº”ç”¨ï¼Œéƒ¨ç½²åœ¨ Sepolia æµ‹è¯•ç½‘ç»œã€‚

### ç‰¹ç‚¹

- ğŸ¨ ç°ä»£åŒ– UI è®¾è®¡
- ğŸ”„ å®æ—¶äº¤æ˜“æŠ¥ä»·
- ğŸ’° æµåŠ¨æ€§ç®¡ç†
- ğŸ“Š æŒä»“å¯è§†åŒ–
- âš¡ å¿«é€Ÿå“åº”

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. Swap (ä»£å¸äº¤æ¢)

**åŠŸèƒ½æè¿°**

- æ”¯æŒä»»æ„ ERC20 ä»£å¸ä¹‹é—´çš„äº¤æ¢
- å®æ—¶ä»·æ ¼è®¡ç®—
- è‡ªåŠ¨æŠ¥ä»·æ›´æ–°
- æ»‘ç‚¹ä¿æŠ¤ (é»˜è®¤ 5%)

**æ–°å¢ï¼šè´¹ç‡é€‰æ‹©** â­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Fee Tier                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 0.05% â”‚ â”‚ 0.30% â”‚ â”‚ 1.00% â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä½¿ç”¨æµç¨‹**

1. é€‰æ‹©è´¹ç‡ (0.05%, 0.30%, 1.00%)
2. é€‰æ‹©è¾“å…¥/è¾“å‡ºä»£å¸
3. è¾“å…¥äº¤æ¢æ•°é‡
4. æŸ¥çœ‹é¢„æœŸè¾“å‡º
5. æˆæƒä»£å¸
6. æ‰§è¡Œäº¤æ¢

### 2. Liquidity (æµåŠ¨æ€§ç®¡ç†)

**åŠŸèƒ½æè¿°**

- æ·»åŠ æµåŠ¨æ€§èµšå–æ‰‹ç»­è´¹
- åŒä»£å¸åŒæ—¶æä¾›
- è‡ªåŠ¨è®¡ç®—æ¯”ä¾‹

**æ–°å¢ï¼šè´¹ç‡é€‰æ‹©** â­

- é€‰æ‹©æƒ³è¦æä¾›æµåŠ¨æ€§çš„è´¹ç‡æ± 
- ä¸åŒè´¹ç‡å¯¹åº”ä¸åŒæ”¶ç›Šç‡
- é«˜è´¹ç‡ = é«˜æ³¢åŠ¨ = é«˜æ”¶ç›Š

**ä½¿ç”¨æµç¨‹**

1. é€‰æ‹©è´¹ç‡å±‚çº§
2. é€‰æ‹©ä»£å¸å¯¹
3. è¾“å…¥ä¸¤ç§ä»£å¸æ•°é‡
4. æˆæƒä¸¤ä¸ªä»£å¸
5. æ·»åŠ æµåŠ¨æ€§

### 3. Positions (æŒä»“ç®¡ç†)

**åŠŸèƒ½æè¿°**

- æŸ¥çœ‹æ‰€æœ‰æµåŠ¨æ€§æŒä»“
- æ˜¾ç¤ºè¯¦ç»†æŒä»“ä¿¡æ¯
- æ”¶å–æ‰‹ç»­è´¹æ”¶ç›Š
- ç§»é™¤æµåŠ¨æ€§

**æ˜¾ç¤ºä¿¡æ¯**

- Position ID
- ä»£å¸å¯¹åœ°å€
- æµåŠ¨æ€§æ•°é‡
- Tick èŒƒå›´
- å·²èµšå–æ‰‹ç»­è´¹
- è´¹ç‡æ ‡ç­¾

**æ“ä½œ**

- Collect Fees - æå–æ‰‹ç»­è´¹
- Remove Liquidity - ç§»é™¤æµåŠ¨æ€§
- Refresh - åˆ·æ–°åˆ—è¡¨

---

## æ–°å¢åŠŸèƒ½

### â­ è´¹ç‡é€‰æ‹©åŠŸèƒ½

#### å®ç°ä½ç½®

1. **Swap.tsx** - äº¤æ¢é¡µé¢
2. **Liquidity.tsx** - æµåŠ¨æ€§é¡µé¢

#### è´¹ç‡é€‰é¡¹

```typescript
const FEE_TIERS = [
  { label: "0.05%", value: 500, index: 0 }, // ç¨³å®šå¸å¯¹
  { label: "0.30%", value: 3000, index: 1 }, // æ ‡å‡†è´¹ç‡ï¼ˆé»˜è®¤ï¼‰
  { label: "1.00%", value: 10000, index: 2 } // é«˜æ³¢åŠ¨å¯¹
]
```

#### ç•Œé¢è®¾è®¡

- ä¸‰ä¸ªæŒ‰é’®æ¨ªå‘æ’åˆ—
- é€‰ä¸­çŠ¶æ€ï¼šæ¸å˜èƒŒæ™¯ + ç™½è‰²æ–‡å­—
- æœªé€‰ä¸­ï¼šæ·±è‰²èƒŒæ™¯ + ç°è‰²è¾¹æ¡†
- æ‚¬åœæ•ˆæœï¼šç´«è‰²è¾¹æ¡†é«˜äº®

#### äº¤äº’é€»è¾‘

```javascript
// Swap é¡µé¢
- åˆ‡æ¢è´¹ç‡ â†’ è‡ªåŠ¨é‡æ–°è·å–æŠ¥ä»·
- ä½¿ç”¨é€‰ä¸­è´¹ç‡çš„ index å‚æ•°

// Liquidity é¡µé¢
- åˆ‡æ¢è´¹ç‡ â†’ åˆ‡æ¢ç›®æ ‡æµåŠ¨æ€§æ± 
- æ·»åŠ åˆ°å¯¹åº”è´¹ç‡çš„æ± å­
```

### ğŸ”§ é’±åŒ…è¿æ¥ä¿®å¤

#### é—®é¢˜

ç‚¹å‡» "Connect Wallet" æŒ‰é’®æ— å“åº”

#### åŸå› åˆ†æ

1. ç¼ºå°‘é”™è¯¯å¤„ç†
2. æ²¡æœ‰å¼‚æ­¥ç­‰å¾…
3. æœªæ£€æŸ¥ connector å¯ç”¨æ€§

#### è§£å†³æ–¹æ¡ˆ

```typescript
const handleConnect = async () => {
  try {
    const injectedConnector = connectors.find((c) => c.id === "injected")
    if (injectedConnector) {
      await connect({ connector: injectedConnector })
    } else {
      alert("Please install MetaMask or another Web3 wallet")
    }
  } catch (err) {
    console.error("Failed to connect:", err)
    alert("Failed to connect wallet. Please try again.")
  }
}
```

#### æ”¹è¿›ç‚¹

- âœ… å¼‚æ­¥å¤„ç†
- âœ… é”™è¯¯æ•è·
- âœ… ç”¨æˆ·æç¤º
- âœ… æ§åˆ¶å°æ—¥å¿—

---

## æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ

```
â”œâ”€â”€ React 18          - UI æ¡†æ¶
â”œâ”€â”€ TypeScript        - ç±»å‹å®‰å…¨
â”œâ”€â”€ Vite             - æ„å»ºå·¥å…·
â”œâ”€â”€ Wagmi v2         - ä»¥å¤ªåŠ Hooks
â”œâ”€â”€ Ethers.js v6     - åŒºå—é“¾äº¤äº’
â””â”€â”€ React Router     - è·¯ç”±ç®¡ç†
```

### é¡¹ç›®ç»“æ„

```
web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/       # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.tsx    # å¯¼èˆªå¤´éƒ¨
â”‚   â”‚   â”œâ”€â”€ Swap.tsx      # äº¤æ¢ç•Œé¢ â­
â”‚   â”‚   â”œâ”€â”€ Liquidity.tsx # æµåŠ¨æ€§ç•Œé¢ â­
â”‚   â”‚   â””â”€â”€ Positions.tsx # æŒä»“ç•Œé¢
â”‚   â”œâ”€â”€ config/           # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ contracts.ts  # åˆçº¦åœ°å€
â”‚   â”‚   â”œâ”€â”€ abis.ts       # åˆçº¦ ABI
â”‚   â”‚   â””â”€â”€ wagmi.ts      # Web3 é…ç½®
â”‚   â”œâ”€â”€ hooks/            # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ useContract.ts
â”‚   â”‚   â””â”€â”€ useTokenBalance.ts
â”‚   â”œâ”€â”€ App.tsx           # ä¸»åº”ç”¨
â”‚   â””â”€â”€ App.css           # æ ·å¼æ–‡ä»¶ â­
```

### åˆçº¦é›†æˆ

```typescript
// SwapRouter - äº¤æ¢è·¯ç”±
interface ExactInputParams {
  tokenIn: address
  tokenOut: address
  indexPath: uint32[] // â­ è´¹ç‡ç´¢å¼•
  recipient: address
  deadline: uint256
  amountIn: uint256
  amountOutMinimum: uint256
  sqrtPriceLimitX96: uint160
}

// PositionManager - æŒä»“ç®¡ç†
interface MintParams {
  token0: address
  token1: address
  index: uint32 // â­ è´¹ç‡ç´¢å¼•
  amount0Desired: uint256
  amount1Desired: uint256
  recipient: address
  deadline: uint256
}
```

---

## ä½¿ç”¨æŒ‡å—

### ç¯å¢ƒå‡†å¤‡

1. **å®‰è£…é’±åŒ…**

   ```
   ä¸‹è½½ MetaMask æµè§ˆå™¨æ’ä»¶
   https://metamask.io/
   ```

2. **åˆ‡æ¢ç½‘ç»œ**

   ```
   ç½‘ç»œï¼šSepolia Testnet
   Chain ID: 11155111
   ```

3. **è·å–æµ‹è¯•å¸**
   ```
   Sepolia ETH æ°´é¾™å¤´
   https://sepoliafaucet.com/
   ```

### å¿«é€Ÿå¼€å§‹

1. **å¯åŠ¨åº”ç”¨**

   ```bash
   cd web
   pnpm install
   pnpm dev
   ```

2. **è¿æ¥é’±åŒ…**

   - ç‚¹å‡»å³ä¸Šè§’ "Connect Wallet"
   - åœ¨ MetaMask ä¸­æˆæƒ

3. **å¼€å§‹äº¤æ˜“**
   - é€‰æ‹©è´¹ç‡
   - é€‰æ‹©ä»£å¸å¯¹
   - è¾“å…¥æ•°é‡
   - æˆæƒå¹¶äº¤æ¢

### è´¹ç‡é€‰æ‹©å»ºè®®

#### 0.05% - ä½è´¹ç‡

- **é€‚ç”¨åœºæ™¯**ï¼šç¨³å®šå¸äº¤æ˜“å¯¹ (å¦‚ USDC/USDT)
- **ç‰¹ç‚¹**ï¼šä½æ»‘ç‚¹ï¼Œä½æ‰‹ç»­è´¹
- **æµåŠ¨æ€§æä¾›è€…**ï¼šæ”¶ç›Šä½ä½†ç¨³å®š

#### 0.30% - æ ‡å‡†è´¹ç‡ (æ¨è)

- **é€‚ç”¨åœºæ™¯**ï¼šå¤§å¤šæ•°äº¤æ˜“å¯¹
- **ç‰¹ç‚¹**ï¼šå¹³è¡¡çš„è´¹ç‡å’ŒæµåŠ¨æ€§
- **æµåŠ¨æ€§æä¾›è€…**ï¼šé€‚ä¸­æ”¶ç›Š

#### 1.00% - é«˜è´¹ç‡

- **é€‚ç”¨åœºæ™¯**ï¼šé«˜æ³¢åŠ¨æ€§ä»£å¸å¯¹
- **ç‰¹ç‚¹**ï¼šé«˜æ‰‹ç»­è´¹è¡¥å¿æ— å¸¸æŸå¤±
- **æµåŠ¨æ€§æä¾›è€…**ï¼šé«˜é£é™©é«˜æ”¶ç›Š

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•é€‰æ‹©åˆé€‚çš„è´¹ç‡ï¼Ÿ

**A:**

- **ç¨³å®šå¸äº¤æ˜“** â†’ é€‰æ‹© 0.05%
- **ä¸»æµå¸äº¤æ˜“** â†’ é€‰æ‹© 0.30%
- **å°å¸ç§äº¤æ˜“** â†’ é€‰æ‹© 1.00%

### Q2: ä¸ºä»€ä¹ˆåˆ‡æ¢è´¹ç‡åæ²¡æœ‰æŠ¥ä»·ï¼Ÿ

**A:**
å¯èƒ½åŸå› ï¼š

1. è¯¥è´¹ç‡æ± å­ä¸å­˜åœ¨
2. æ± å­æ²¡æœ‰æµåŠ¨æ€§
3. ç½‘ç»œå»¶è¿Ÿ

è§£å†³æ–¹æ³•ï¼š

- å°è¯•å…¶ä»–è´¹ç‡
- æ£€æŸ¥æ˜¯å¦æœ‰è¯¥äº¤æ˜“å¯¹çš„æ± å­
- åˆ·æ–°é¡µé¢é‡è¯•

### Q3: é’±åŒ…è¿æ¥åè¿˜æ˜¯æ— æ³•äº¤æ˜“ï¼Ÿ

**A:**
æ£€æŸ¥æ¸…å•ï¼š

- âœ… æ˜¯å¦åœ¨ Sepolia ç½‘ç»œ
- âœ… æ˜¯å¦æœ‰è¶³å¤Ÿçš„ ETH (Gas è´¹)
- âœ… æ˜¯å¦æœ‰è¶³å¤Ÿçš„ä»£å¸ä½™é¢
- âœ… æ˜¯å¦å·²æˆæƒä»£å¸

### Q4: å¦‚ä½•è·å–æµ‹è¯•ä»£å¸ï¼Ÿ

**A:**

1. å…ˆè·å– Sepolia ETH
2. ä½¿ç”¨æµ‹è¯•ä»£å¸åˆçº¦é“¸é€ 
3. æˆ–è”ç³»é¡¹ç›®æ–¹è·å–

---

## æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. æ£€æŸ¥ MetaMask é’±åŒ…é…ç½®
3. é˜…è¯» README.md
4. æŸ¥çœ‹ CHANGELOG.md

---

## æ›´æ–°è®¡åˆ’

æœªæ¥å¯èƒ½å¢åŠ ï¼š

- [ ] å¤šè·³è·¯ç”±ä¼˜åŒ–
- [ ] ä»·æ ¼å›¾è¡¨
- [ ] äº¤æ˜“å†å²è®°å½•
- [ ] æ›´å¤šä»£å¸æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] æ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢

---

**ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2025-10-22  
**ç½‘ç»œ**: Sepolia Testnet
