# MetaNodeSwap 前端启动说明

## 已完成的功能

✅ **问题修复**

1. 修复了钱包连接问题 - 添加了错误处理和用户提示
2. 添加了费率选择功能 - Swap 和 Liquidity 页面都支持选择 0.05%, 0.30%, 1.00% 三种费率

✅ **核心功能**

- 代币交换 (Swap) - 支持费率选择
- 添加流动性 (Liquidity) - 支持费率选择
- 查看和管理持仓 (Positions)
- 钱包连接 - MetaMask 等
- 实时余额显示
- 交易报价预览

## 快速启动

### 1. 安装依赖

```bash
cd web
pnpm install
```

### 2. 启动开发服务器

```bash
pnpm dev
```

应用将在 http://localhost:3000 启动

### 3. 连接钱包

1. 点击右上角 "Connect Wallet" 按钮
2. 确保安装了 MetaMask 钱包
3. 切换到 Sepolia 测试网
4. 授权连接

## 使用流程

### Swap (代币交换)

1. **选择费率** - 在顶部选择交易费率 (0.05%, 0.30%, 1.00%)
2. **选择代币对** - 在 From/To 下拉框中选择要交换的代币
3. **输入数量** - 系统会自动计算输出数量
4. **授权** - 点击 "Approve" 授权代币使用
5. **交换** - 点击 "Swap" 执行交易

### Liquidity (添加流动性)

1. **选择费率** - 选择要提供流动性的费率池
2. **选择代币对** - 选择两个代币
3. **输入数量** - 分别输入两个代币的数量
4. **授权代币** - 点击 "Approve Tokens" 授权两个代币
5. **添加流动性** - 点击 "Add Liquidity" 完成

### Positions (管理持仓)

1. 查看所有流动性持仓
2. 收取手续费收益 - 点击 "Collect Fees"
3. 移除流动性 - 点击 "Remove Liquidity"

## 费率说明

不同的费率对应不同的流动性池：

- **0.05%** - 适合稳定币对，滑点小
- **0.30%** - 通用费率，适合大多数交易对 (默认)
- **1.00%** - 适合波动性大的代币对

## 注意事项

⚠️ **重要**

- 这是 Sepolia 测试网应用
- 每次交易前需要先授权代币
- 不同费率的池子是独立的
- 建议先在小额测试
- 默认滑点容差为 5%

## 合约地址

**测试代币 (Sepolia)**

- MNTokenA: `0x4798388e3adE569570Df626040F07DF71135C48E`
- MNTokenB: `0x5A4eA3a013D42Cfd1B1609d19f6eA998EeE06D30`
- MNTokenC: `0x86B5df6FF459854ca91318274E47F4eEE245CF28`
- MNTokenD: `0x7af86B1034AC4C925Ef5C3F637D1092310d83F03`

**核心合约**

- PoolManager: `0xddC12b3F9F7C91C79DA7433D8d212FB78d609f7B`
- PositionManager: `0xbe766Bf20eFfe431829C5d5a2744865974A0B610`
- SwapRouter: `0xD2c220143F5784b3bD84ae12747d97C8A36CeCB2`

## 常见问题

**Q: 点击 Connect Wallet 没反应？**
A:

- 确保已安装 MetaMask 浏览器插件
- 检查浏览器控制台是否有错误
- 刷新页面重试

**Q: 交易失败？**
A: 可能的原因：

- 余额不足
- 未授权代币
- Gas 费不足
- 滑点设置过低
- 选择的费率池子不存在或没有流动性

**Q: 如何获取测试代币？**
A:

1. 先从水龙头获取测试 ETH
2. 使用测试代币合约的 mint 功能铸造

**Q: 费率选择后报价为空？**
A: 该费率的池子可能还没有创建或没有流动性，尝试其他费率

## 技术栈

- React 18 + TypeScript
- Vite - 快速构建
- Wagmi v2 - 以太坊 React Hooks
- Ethers.js v6 - 区块链交互
- React Router - 路由管理

## 开发命令

```bash
# 开发模式
pnpm dev

# 构建生产版本
pnpm build

# 预览生产构建
pnpm preview
```

---

如有问题，请查看浏览器控制台的错误信息，或检查 MetaMask 钱包是否正确配置。
